**There were 3 Tables: WorldCups, WorldCupMatches and WorldCup_2018**


**CLEANING TABLE WORLDCUPS**:

--ADDING 2018 DATA TO WORLDCUPS:
  
  INSERT INTO WorldCups (Year, Country, Winner, Runners_Up, Third, Fourth, GoalsScored, QualifiedTeams, MatchesPlayed)
VALUES (2018, 'Russia', 'France', 'Croatia', 'Belgium', 'England', 169, 32, 64);


**CLEANING TABLE WORLDCUP_2018**

-- Splitting column Date_time into two wusing PARSENAME:

SELECT PARSENAME (REPLACE (Date_time, '-', '.'), 1) AS time_of_day,
  PARSENAME (REPLACE (Date_time, '-', '.'), 2) AS game_day
FROM worldcup_2018


ALTER TABLE Worldcup_2018
ADD time_of_day TIME 

UPDATE worldcup_2018 
SET time_of_day = PARSENAME (REPLACE (Date_time, '-', '.'), 1) 


ALTER TABLE Worldcup_2018
ADD game_day nvarchar(255)

UPDATE worldcup_2018 
SET game_day = PARSENAME (REPLACE (Date_time, '-', '.'), 2)


--Deleting column Date_time:

ALTER TABLE Worldcup_2018
DROP COLUMN Date_time

--Deleting other columns:

ALTER TABLE Worldcup_2018
  DROP COLUMN Assistant1, Assistant2, MatchID



**CLEANING TABLE WORLDCUPMATCHES**

-- Splitting column Date_time into two wusing PARSENAME:

SELECT PARSENAME (REPLACE (Date_time, '-', '.'), 1) AS time_of_day,
  PARSENAME (REPLACE (Date_time, '-', '.'), 2) AS game_day
FROM WorldCupMatches


ALTER TABLE WorldCupMatches
ADD time_of_day nvarchar(255)

UPDATE WorldCupMatches
SET time_of_day = PARSENAME (REPLACE (Date_time, '-', '.'), 1) 


ALTER TABLE WorldCupMatches
ADD game_day nvarchar(255)

UPDATE WorldCupMatches 
SET game_day = PARSENAME (REPLACE (Date_time, '-', '.'), 2)


--Deleting column Date_time:

ALTER TABLE WorldCupMatches
DROP COLUMN Date_time

--Deleting other columns:

ALTER TABLE WorldCupMatches
  DROP COLUMN Assistant1, Assistant2, MatchID, Home_Team_Initials, Away_Team_Initials, RoundID
  
  
--Looking for Duplicates:

--Initial Query:

SELECT *,
ROW_NUMBER () OVER (
PARTITION BY Stage,
	Stadium,
	City,
	Home_Team_Name,
	Home_Team_Goals,
	Away_Team_Goals,
	Away_Team_Name,
	Win_Conditions,
	Attendance,
	Half_time_Home_Goals,
	Half_time_Away_Goals, 
	Referee,
	time_of_day,
	Game_day
			ORDER BY
			Year
			) row_num
FROM WorldCupMatches

--Using CTE to Pull Duplicates:

WITH RownumCTE AS (
SELECT *,
ROW_NUMBER () OVER (
PARTITION BY Stage,
	Stadium,
	City,
	Home_Team_Name,
	Home_Team_Goals,
	Away_Team_Goals,
	Away_Team_Name,
	Win_Conditions,
	Attendance,
	Half_time_Home_Goals,
	Half_time_Away_Goals, 
	Referee,
	time_of_day,
	Game_day
			ORDER BY
			Year
			) row_num
FROM WorldCupMatches)
SELECT *
FROM RownumCTE
WHERE row_num > 1
ORDER BY Year

--Deleting Duplicates:

WITH RownumCTE AS (
SELECT *,
ROW_NUMBER () OVER (
PARTITION BY Stage,
	Stadium,
	City,
	Home_Team_Name,
	Home_Team_Goals,
	Away_Team_Goals,
	Away_Team_Name,
	Win_Conditions,
	Attendance,
	Half_time_Home_Goals,
	Half_time_Away_Goals, 
	Referee,
	time_of_day,
	Game_day
			ORDER BY
			Year
			) row_num
FROM WorldCupMatches)
DELETE
FROM RownumCTE
WHERE row_num > 1
  
--Checking NULL Values:

SELECT *
  FROM WorldCupMatches
  WHERE attendance IS NULL
  
--Fixing NULL Values:

UPDATE WorldCupMatches
SET Attendance = 43063
WHERE year = '2014' and Stage = 'Round of 16' and home_team_name = 'Germany' 

(**Data was found of Wikipedia: https://en.wikipedia.org/wiki/2014_FIFA_World_Cup#Round_of_16)


  
  


  
  

